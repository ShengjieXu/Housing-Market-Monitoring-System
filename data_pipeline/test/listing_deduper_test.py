import logging
import os
import sys
import unittest

sys.path.insert(0, os.path.join(os.path.dirname(__file__), ".."))
sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "..", "common", "client"))
sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "..", "common", "logger"))
from default_logger import set_default_dual_logger
from listing_deduper import _handle_task
import mongodb


class HandleTaskTestCase(unittest.TestCase):
    def setUp(self):
        self.tasks = ['{"category": "apa", "craigslist_id": "6392341784", "post_datetime": "2017-11-18T13:13:19-0800", "features": ["cats are OK - purrr", "apartment", "laundry in bldg"], "title": "1 Bedroom in Westwood-Nearby UCLA-Sauna-Heated Pool", "url": "https://losangeles.craigslist.org/wst/apa/d/1-bedroom-in-westwood-nearby/6392341784.html", "geo": {"latitude": "34.064209", "longitude": "-118.441112"}, "region": "losangeles", "body": ["QR Code Link to This Post", "WELCOME TO HILGARD APARTMENTS", "With a peaceful setting yet easy access to shopping, fine dining and the I-405, you\'ll experience the best of both worlds when you live at Hilgard Apartments! Directly across the street from UCLA Medical Center and Business School, our community is located in the heart of Westwood Village.", "You have many choices when you come to Hilgard Apartments.  We offer both unfurnished and furnished apartments.  We also offer housekeeping services so you don\'t have to worry about a thing.    You can even choose extra features such as an apartment with den/study area and a private balcony/patio.", "Our heated pool and sauna are perfect for some R&R.   If you like to keep active, we have a state of the art fitness center that will keep your fitness goals on track.", "Whether you need a short term or long term lease, our staff is here to find the perfect home for you.", "show contact info", "870 Hilgard Avenue Westwood, CA 90024", "COMMUNITY AMENITIES", "Assigned Parking, Cedar Sauna, Heated Pool, Housekeeping available, Laundry Facility, Modern Gym", "APARTMENT AMENITIES", "Stainless Steel Appliances*, A.C., Breakfast Bar, Plank Floors, Ceiling Fan, Dishwasher*, Furnished Available, Disposal, Microwave*, Private Balconies and Patios*, Refrigerator*, Walk In Closet(s)", "PET POLICY", "Cats welcome with additional deposit. Call for Details And Restrictions.", "DISCLAIMER", "Any Interior Pictures May Not Be Of Exact Apartment Home.", "Square Footage Is Approximate.", "*With Select Apartment Homes.", "Zip Codes: 90034, 90233, 90231, 90232, 90064, 90035, 90067, 90212, 90230, 90016, 90211, 90025, 90066, 90056, 90213, 90048, 90024, 90008, 90084, 90073, 90019, 90094, 90095, 90036, 90295, 90405, 90404, 90294, 90291, 90292, 90069, 90043, 90018, 90302", "Nearby Places: Trader Joe\'s, Bank of America, Ralph\'s, David Geffen School of Medicine, Geffen Playhouse Theatre, Target, Whole Foods"], "bed": "1BR", "bath": "1Ba", "price": "$2695", "update_datetime": "2017-11-24T17:37:34-0800", "street": "Hilgard Avenue at Le Conte Avenue", "available_date": "2018-01-24", "open_house_dates": [], "img_url": "https://images.craigslist.org/00606_ldsVVHjf1AA_600x450.jpg", "city": "(Westwood - Near UCLA)", "size": "700ft2"}',
                      '{"category": "apa", "craigslist_id": "10", "post_datetime": "2017-11-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE", "url": "URL", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2017-11-24", "open_house_dates": [], "img_url": "IMG_URL", "city": "", "size": "792ft2"}',
                      '{"category": "apa", "craigslist_id": "10", "post_datetime": "2018-05-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE", "url": "URL", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2018-05-23", "open_house_dates": [], "img_url": "IMG_URL", "city": "", "size": "792ft2"}',
                      '{"category": "apa", "craigslist_id": "10", "post_datetime": "2018-11-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE", "url": "URL", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2018-05-24", "open_house_dates": [], "img_url": "IMG_URL", "city": "", "size": "792ft2"}',
                      '{"category": "apa", "craigslist_id": "10", "post_datetime": "2017-11-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE", "url": "URL", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2017-11-24", "open_house_dates": [], "img_url": "IMG_URL", "city": "", "size": "792ft2"}',
                      '{"category": "apa", "craigslist_id": "10", "post_datetime": "2017-11-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE_01", "url": "URL_1", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2017-11-24", "open_house_dates": [], "img_url": "IMG_URL_01", "city": "", "size": "792ft2"}',
                      '{"category": "apa", "craigslist_id": "12", "post_datetime": "2017-11-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE", "url": "URL_1", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2017-11-24", "open_house_dates": [], "img_url": "IMG_URL_01", "city": "", "size": "792ft2"}',
                      '{"category": "apa", "craigslist_id": "13", "post_datetime": "2017-11-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE_01", "url": "URL", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2017-11-24", "open_house_dates": [], "img_url": "IMG_URL_01", "city": "", "size": "792ft2"}',
                      '{"category": "apa", "craigslist_id": "14", "post_datetime": "2017-11-24T17:41:58-0800", "features": ["apartment"], "title": "TITLE_01", "url": "URL_1", "geo": {"latitude": "34.241130", "longitude": "-118.536119"}, "region": "losangeles", "body": ["QR Code Link to This Post", "Meridian Place Apartment Homes", "9423 Reseda Blvd., Northridge, CA, 91324", "Call Now -", "show contact info", "x 59", "OR Text", "59", "to", "show contact info", "to text our team directly.", "Want more info on this unit? See the link (below):", "http://apartments.wng.com/209t6h", "This is a 1 Bedroom, 1 Bath, approximately 792 Sq. Ft.", "Meridian Place Apartment Homes, where urban meets style! We are conveniently located in the heart of Northridge, California, just across the street from Cal State University, Northridge. The Northridge Fashion Center and the 118, 405 and 101 Freeways are right nearby. Meridian Place features lavish interiors such as gourmet kitchens with granite countertops, wood-style flooring, and complete appliance packages including a full-sized stackable washer and dryer, refrigerator, microwave, and dishwasher. Our first class amenities make coming home so much more exciting! Bring your laptop and lounge by our swimming pool, or relax in our clubhouse complete with free WiFi access! You may also enjoy our billiard room or media room. There is also a wonderful dog park for our four-legged residents to enjoy! Meridian Place Apartment Homes, where life is made easy and living is done right!", "*Floor plan availability and pricing subject to change. Square footage and/or room dimensions are approximations and may vary between individual apartment units.", "Western National Property Management", "CA BRE LIC #00838846", "Pet Policy:", "BRING YOUR FURRY FRIENDS HOME!", "Meridian Place Apartment Homes is a pet friendly community!", "We accept both cats and dogs under 35 Lbs.", "$400 pet deposit and $35 monthly pet fee per cat.", "$400 pet deposit and $45 monthly pet fee per dog.", "Maximum of two pets per apartment home.", "Driving Directions:", "From the San Diego Freeway (405): Heading north: Exit at Nordhoff Street/Left on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. Heading south: Exit at Nordhoff Street/Right on Nordhoff to Reseda/ Right on Reseda. Meridian Place will be on your left hand side. From the Ronald Reagan Freeway (118): Heading west: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer. Heading east: Exit at Reseda Blvd/Right on Reseda. Meridian Place will be on your right just after Plummer.", "Office Hours:", "09:00 AM - 6:00PM Daily", "Equal Housing Opportunity", "Los Angeles Northridge Cal State University Northridge CSUN LAX Camarillo Ventura Fashion Center 405 Freeway 118 Freeway Reseda Blvd", "s5CvlAonxlU"], "bed": "1BR", "bath": "1Ba", "price": "$2100", "update_datetime": "", "street": "9423 Reseda Blvd.", "available_date": "2017-11-24", "open_house_dates": [], "img_url": "IMG_URL", "city": "", "size": "792ft2"}',]

    def test_get_details(self):
        logger = logging.getLogger(__name__)
        for task in self.tasks:
            _handle_task(task)
        db = mongodb.get_db()
        self.assertEqual(db["losangeles"].count(), 3)


if __name__ == "__main__":
    set_default_dual_logger("listing_deduper_test.log", "a")
    unittest.main()
